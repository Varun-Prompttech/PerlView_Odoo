<?xml version="1.0" encoding="UTF-8"?>
<templates id="template" xml:space="preserve">
    <!-- Patch Receipt Header for Tax Invoice Label and Address -->
    <t t-name="pos_payment_oma.ReceiptHeader" t-inherit="point_of_sale.ReceiptHeader" t-inherit-mode="extension">
        <xpath expr="//div[hasclass('pos-receipt-contact')]" position="before">
            <div class="text-center fw-bolder fs-2 mb-2">TAX INVOICE</div>
        </xpath>
        <xpath expr="//div[hasclass('pos-receipt-contact')]/div[1]" position="after">
            <div t-if="props.data.company.street" t-esc="props.data.company.street" />
            <div t-if="props.data.company.street2" t-esc="props.data.company.street2" />
            <div t-if="props.data.company.city">
                <t t-esc="props.data.company.city"/> <t t-if="props.data.company.state_id" t-esc="props.data.company.state_id[1]"/>
            </div>
        </xpath>
        <xpath expr="//t[@t-if='props.data.company.vat']" position="replace">
            <t t-if="props.data.company.vat">
                <div class="fw-bold">TRN: <t t-esc="props.data.company.vat"/></div>
            </t>
        </xpath>
    </t>

    <!-- Patch Orderline for Product on Top, Qty Breakdown Below -->
    <t t-name="pos_payment_oma.Orderline" t-inherit="point_of_sale.Orderline" t-inherit-mode="extension">
        <xpath expr="//div[hasclass('d-flex', 'flex-column', 'w-100', 'gap-1')]" position="replace">
            <div class="d-flex flex-column w-100">
                <!-- Line 1: Product Name and Subtotal -->
                <div class="d-flex justify-content-between align-items-start">
                    <div class="product-name fw-bolder text-wrap" style="max-width: 75%;">
                        <span t-esc="line.productName"/>
                    </div>
                    <div class="product-price fw-bolder text-end">
                        <t t-esc="line.price"/>
                    </div>
                </div>
                <!-- Line 2: Qty x Unit Price -->
                <div class="d-flex justify-content-start small text-muted mt-1">
                    <div class="price-per-unit">
                        <t t-esc="line.qty"/> <t t-if="line.unit" t-esc="line.unit"/> x <t t-esc="line.unitPrice"/>
                    </div>
                </div>
                <!-- Customer Note -->
                <div t-if="line.customerNote" class="customer-note w-100 p-1 mt-1 rounded text-break text-bg-warning bg-opacity-25 small">
                    <t t-esc="line.customerNote" />
                </div>
            </div>
        </xpath>
    </t>
</templates>
