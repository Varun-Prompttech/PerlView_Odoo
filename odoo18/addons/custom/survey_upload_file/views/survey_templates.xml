<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <!-- Extend the survey.question_container template to include upload input -->
    <template id="question_page_upload_answer" inherit_id="survey.question_container">
        <xpath expr="//div[@role='alert']" position="before">
            <t t-if="question.question_type == 'upload_file'">
                <t t-call="survey_upload_file.multi_upload_file"/>
            </t>
        </xpath>
    </template>

    <!-- Upload file input template -->
    <template id="multi_upload_file">
        <div class="o_survey_upload_container">
            <div class="o_survey_upload_box" id="survey_upload_box">
                <div class="o_survey_upload_box_header">Upload Files</div>
                <br/>
                <div class="o_survey_upload_box_body">
                    <input type="file"
                           class="o_survey_upload_file"
                           data-oe-data=""
                           data-oe-file_name=""
                           t-att-data-question-type="question.question_type"
                           t-att-name="question.id"
                           t-att-multiple="question.upload_multiple_file"
                    />
                </div>
            </div>
            <br/>
            <!-- âœ… UNIQUE ID for file list per question -->
            <div t-attf-id="fileList_{{ question.id }}" class="o_survey_upload_list"/>
            <t t-if="question.upload_multiple_file == False">
                <div class="o_survey_upload_note">Note: You can only upload one file.</div>
            </t>
            <t t-if="question.upload_multiple_file == True">
                <div class="o_survey_upload_note">Note: You can upload multiple files.</div>
            </t>
        </div>
    </template>

    <!-- Show uploaded file attachments in print page -->
    <template id="survey_page_print_upload_answer" inherit_id="survey.survey_page_print">
        <xpath expr="//div[hasclass('o_survey_question_error')]" position="before">
            <t t-if="question.question_type == 'upload_file'">
                <t t-call="survey_upload_file.multi_upload_answer"/>
            </t>
        </xpath>
    </template>

    <!-- Render answer attachments -->
    <template id="multi_upload_answer">
        <t t-if="answer_lines.value_file_data_ids">
            <div>
                <t t-foreach="answer_lines.value_file_data_ids" t-as="attachment">
                    <a t-attf-href="/web/content/{{ attachment.id }}?download=true">
                        <i class="fa fa-download"/>
                        <t t-esc="attachment.name"/>
                    </a>
                    <br/>
                </t>
            </div>
        </t>
    </template>
</odoo>
