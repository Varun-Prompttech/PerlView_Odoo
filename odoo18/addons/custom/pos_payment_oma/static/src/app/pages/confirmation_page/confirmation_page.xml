<?xml version="1.0" encoding="UTF-8"?>
<templates id="template" xml:space="preserve">
    <t t-name="pos_payment_oma.ConfirmationPage" t-inherit="pos_self_order.ConfirmationPage" t-inherit-mode="extension">
        <xpath expr="//div[hasclass('d-inline-flex')]" position="replace">
            <div class="d-inline-flex flex-column border rounded py-4 px-5 bg-view mb-3">
                <span class="fs-2 text-muted">Order Reference</span>
                <span class="fs-1 fw-bold text-primary" t-esc="confirmedOrder.pos_reference || confirmedOrder.name" />
                <span class="fs-4 text-muted mt-2" t-if="confirmedOrder.tracking_number">Token: <t t-esc="confirmedOrder.tracking_number"/></span>
            </div>
            
            <!-- Fallback Print Button if Direct Thermal Print Fails -->
            <div t-if="state.printError" class="alert alert-warning d-flex flex-column align-items-center mt-3 mx-4">
                <p class="mb-2 text-center">
                    <i class="fa fa-exclamation-triangle me-2"/>
                    <t t-esc="state.errorMessage"/>
                </p>
                <button class="btn btn-primary btn-lg w-100" t-on-click="printInvoiceBrowser">
                    <i class="fa fa-print me-2"/> Print Invoice via Browser
                </button>
            </div>
        </xpath>
    </t>
</templates>
