<?xml version="1.0" encoding="UTF-8"?>
<templates xml:space="preserve">
    <t t-name="ks_list_view">
        <t t-if="props.record.data.ks_data_calculation_type == 'custom' and props.record.data.ks_model_id and props.record.data.ks_dashboard_item_type == 'ks_list_view'">
            <t t-if="props.record.data.ks_list_view_type == 'ungrouped' ">
                <t t-if="props.record.data.ks_list_view_fields.count != 0">
<!--                    <t t-set="value" t-value="value()"/>-->
                    <t t-call="ks_dashboard_ninja.ks_list_view_container"/>
                </t>
                <t t-else="">
                    <div>
                        Select Fields to show in list view
                    </div>
                </t>
            </t>
            <t t-elif="props.record.data.ks_list_view_type == 'grouped'">
                <t t-if="props.record.data.ks_list_view_group_fields.count != 0 and props.record.data.ks_chart_relation_groupby">
                    <t t-if="props.record.data.ks_chart_groupby_type == 'relational_type' or  props.record.data.ks_chart_groupby_type == 'selection' or props.record.data.ks_chart_groupby_type == 'other' or (props.record.data.ks_chart_groupby_type == 'date_type' and props.record.data.ks_chart_date_groupby)">
<!--                        <t t-set="value" t-value="value()"/>-->
                        <t t-call="ks_dashboard_ninja.ks_list_view_container"/>
                    </t>
                    <t t-else="">
                        <div>
                            Select Group by Date to show list data.
                        </div>
                    </t>
                </t>
                <t t-else="">
                    <div>
                        Select Fields and Group By to show in list view
                    </div>
                </t>
            </t>
        </t>
        <t t-elif="props.record.data.ks_data_calculation_type == 'query'">
            <t t-if="props.record.data.ks_query_result">
<!--                <t t-set="value" t-value="value()"/>-->
                <t t-call="ks_dashboard_ninja.ks_list_view_container"/>
            </t>
            <t t-else="">
                <div>
                    Please run the appropriate Query
                </div>
            </t>
        </t>
        <t t-else="">
            <div>
                Select a model first
            </div>
        </t>
    </t>

    <t t-name="ks_dashboard_ninja.ks_list_view_container">
        <div class="container-fluid">

            <div class="row">
                <div class="card shadow p-0 m-0">
                    <div class="p-3 py-3 d-flex flex-row align-items-center justify-content-between ">
                        <h6 class="m-0 font-weight-bold h3 ks_chart_heading text-capitalize text-start" t-att-title="ks_list_view_name">
                            <t t-esc="ks_list_view_name"/>
                        </h6>
                    </div>
                    <div class="card-body table-responsive ksMaxTableContent ks_list_item_table">
                        <t t-if="state.list_view_data?.label?.length">
                            <table id="ksListViewTable" class="table table-hover"
                                   t-att-data-model="state.list_view_data['model']">
                                <thead>
                                    <tr>
                                        <t t-foreach="state.list_view_data['label']" t-as="table_header" t-key="table_header_index">
                                            <th>
                                                <t t-esc="table_header"/>
                                            </th>
                                        </t>
                                        <th/>
                                    </tr>
                                </thead>
                                <tbody>
                                    <t t-foreach="state.list_view_data['data_rows']" t-as="table_row" t-key="table_row_index">
                                        <tr class="ks_tr" t-att-data-record-id="table_row['id']">
                                            <t t-set="ks_rec_count" t-value="0"/>
                                            <t t-foreach="table_row['data']" t-as="row_data" t-key="row_data_index">

                                                <t t-if="table_row['ks_column_type'][ks_rec_count]==='html'">
                                                    <td>
                                                        <t t-out="markup(row_data)"/>
                                                    </td>
                                                    <t t-set="ks_rec_count" t-value="ks_rec_count+1"/>
                                                </t>
                                                <t t-elif="table_row['ks_column_type'][ks_rec_count]=='many2one'">
                                                    <td class="ks_list_canvas_click">
                                                        <t t-raw="row_data[1]"/>
                                                    </td>
                                                    <t t-set="ks_rec_count" t-value="ks_rec_count+1"/>
                                                </t>
                                                <t t-elif="table_row['ks_column_type'][ks_rec_count] == 'boolean'">
                                                    <td class="ks_list_canvas_click">
                                                        <t t-out="row_data"/>
                                                    </td>
                                                    <t t-set="ks_rec_count" t-value="ks_rec_count+1"/>
                                                </t>
                                                <t t-else="">
                                                    <td>
                                                        <t t-esc="row_data"/>
                                                    </td>
                                                    <t t-set="ks_rec_count" t-value="ks_rec_count+1"/>
                                                </t>
                                            </t>
                                            <td>
                                                <t t-if="ks_show_records == true">
                                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 20 20" fill="none">
                                                        <path d="M9.16675 1.66663H7.50008C3.33341 1.66663 1.66675 3.33329 1.66675 7.49996V12.5C1.66675 16.6666 3.33341 18.3333 7.50008 18.3333H12.5001C16.6667 18.3333 18.3334 16.6666 18.3334 12.5V10.8333" stroke="#241C1D" stroke-width="1.25" stroke-linecap="round" stroke-linejoin="round"/>
                                                        <path d="M13.3666 2.51663L6.7999 9.0833C6.5499 9.3333 6.2999 9.82497 6.2499 10.1833L5.89157 12.6916C5.75823 13.6 6.3999 14.2333 7.30823 14.1083L9.81657 13.75C10.1666 13.7 10.6582 13.45 10.9166 13.2L17.4832 6.6333C18.6166 5.49997 19.1499 4.1833 17.4832 2.51663C15.8166 0.849966 14.4999 1.3833 13.3666 2.51663Z" stroke="#241C1D" stroke-width="1.25" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>
                                                        <path d="M12.425 3.45837C12.9834 5.45004 14.5417 7.00837 16.5417 7.57504" stroke="#241C1D" stroke-width="1.25" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round"/>
                                                    </svg>
                                                </t>
                                            </td>
                                        </tr>
                                    </t>
                                    <tr t-if="count">
                                        <td class="ks_font"></td>
                                    </tr>
                                </tbody>
                            </table>
                        </t>
                        <t t-else="">
                            <div class="d-flex justify-content-center align-items-center h-100">
                                No Data Present
                            </div>
                        </t>
                    </div>
                </div>
            </div>
        </div>
    </t>
</templates>